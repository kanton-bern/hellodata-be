<div class="comments-container">

  <div class="comments-header">
    <h4 class="text-center">{{ '@Comments' | transloco }}</h4>
  </div>

  <div class="comment-scrollpanel" #scrollContainer>
    @if (comments?.length) {
      <div class="comments-list">
        @for (comment of comments; track comment.createdDate; let i = $index) {
          <div class="comment-item border rounded-md bg-white px-2 py-2 mb-2">
            <p class="comment-text p-1">{{ comment.text }}</p>
            <div class="comment-footer p-1">
              <small class="comment-meta">
                {{ comment.author }} â€“ {{ comment.createdDate | date:'short' }}@if (comment.lastEditedDate) {
                (edited)
              }
              </small>
              <div class="comment-actions">
                <span class="status-dot"
                      [class.published]="comment.status === 'PUBLISHED'"
                      [class.draft]="comment.status === 'DRAFT'"
                      [title]="comment.status"></span>
                <button class="info-btn" (click)="toggleDetails(i)">
                  <i class="fa fa-info-circle"></i>
                </button>
              </div>
            </div>
            @if (expandedCommentIndex === i) {
              <div class="comment-details p-1">
                <small>
                  <div><strong>Status:</strong> {{ comment.status }}</div>
                  <div><strong>Created:</strong> {{ comment.createdDate | date:'medium' }}</div>
                  @if (comment.publishedDate) {
                    <div><strong>Published:</strong> {{ comment.publishedDate | date:'medium' }}</div>
                  }
                  @if (comment.lastEditedDate) {
                    <div><strong>Last edited:</strong> {{ comment.lastEditedDate | date:'medium' }}</div>
                  }
                </small>
              </div>
            }
          </div>
        }
      </div>
    } @else {
      <div class="h-full flex items-center justify-center text-gray-400">
        No comments.
      </div>
    }
  </div>

  <div class="comment-form">
      <textarea
        class="w-full border rounded-md"
        [(ngModel)]="newCommentText"
        placeholder="{{ '@Write a comment' | transloco }}"
        rows="3">
      </textarea>

    <p-button severity="success" pRipple pButton
              label="{{ '@Submit' | transloco }}"
              class="mt-2 w-full"
              (click)="submitComment()"
              (keydown)="submitComment()"
              [disabled]="!newCommentText?.trim()">
    </p-button>
  </div>

</div>
