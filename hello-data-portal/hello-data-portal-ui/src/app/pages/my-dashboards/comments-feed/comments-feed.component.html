<div class="comments-container">

  <div class="comments-header">
    <h4 class="text-center">{{ '@Comments' | transloco }}</h4>
  </div>

  <div class="comment-scrollpanel" #scrollContainer>
    @if ((comments$ | async); as comments) {
      @if (comments.length) {
        <div class="comments-list">
          @for (comment of comments; track comment.id) {
            <app-comment-entry [comment]="comment"></app-comment-entry>
          }
        </div>
      } @else {
        <div class="h-full flex items-center justify-center text-gray-400">
          No comments.
        </div>
      }
    } @else {
      <div class="h-full flex items-center justify-center text-gray-400">
        No comments.
      </div>
    }
  </div>

  <div class="comment-form">
      <textarea
        class="w-full border rounded-md"
        [(ngModel)]="newCommentText"
        placeholder="{{ '@Write a comment' | transloco }}"
        rows="3">
      </textarea>

    <p-button severity="success" pRipple pButton
              label="{{ '@Submit' | transloco }}"
              class="mt-2 w-full"
              (click)="submitComment()"
              (keydown)="submitComment()"
              [disabled]="!newCommentText?.trim()">
    </p-button>
  </div>

</div>

<p-confirmDialog #cd1 key="publishComment" [style]="{width: '50vw'}">
  <ng-template pTemplate="footer">
    <p-button (click)="cd1.onReject()" icon="fas fa-circle-xmark" label="{{'@Cancel' | transloco}}"
              (keydown)="cd1.onReject()"
              severity="secondary" pRipple pButton/>
    <p-button (click)="cd1.onAccept()" icon="fas fa-cloud-arrow-up"
              label="{{'@Publish' | transloco}}" (keydown)="cd1.onAccept()"
              severity="success" pRipple pButton/>
  </ng-template>
</p-confirmDialog>

<p-confirmDialog #cd2 key="unpublishComment" [style]="{width: '50vw'}">
  <ng-template pTemplate="footer">
    <p-button (click)="cd2.onReject()" icon="fas fa-circle-xmark" label="{{'@Cancel' | transloco}}"
              (keydown)="cd2.onReject()"
              severity="secondary" pRipple pButton/>
    <p-button (click)="cd2.onAccept()" icon="fas fa-cloud-arrow-down"
              label="{{'@Unpublish' | transloco}}" (keydown)="cd2.onAccept()"
              severity="warn" pRipple pButton/>
  </ng-template>
</p-confirmDialog>

<p-confirmDialog #cd3 key="deleteComment" [style]="{width: '50vw'}">
  <ng-template pTemplate="footer">
    <p-button (click)="cd3.onReject()" icon="fas fa-circle-xmark" label="{{'@Cancel' | transloco}}"
              (keydown)="cd3.onReject()"
              severity="secondary" pRipple pButton/>
    <p-button (click)="cd3.onAccept()" icon="fas fa-trash"
              label="{{'@Delete' | transloco}}" (keydown)="cd3.onAccept()"
              severity="danger" pRipple pButton/>
  </ng-template>
</p-confirmDialog>

