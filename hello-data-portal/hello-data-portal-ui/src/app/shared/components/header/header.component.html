@if (availableDataDomains$ | async) {
}
@if (translationsLoaded$ | async) {
}
<div [ngStyle]="environment.color && { 'background-color': environment.color } || null"
     class="layout-topbar flex w-full flex-nowrap items-center justify-between gap-4 py-2 pr-4" id="layout-topbar">
  <!-- Left column: Env + Title + Data Domain Selector -->
  <div class="topbar-left-group shrink-0">
    @if (environment.showEnvironment) {
      <span class="env-badge glow" [pTooltip]="'@Environment' | transloco" tooltipPosition="bottom">
        {{ environment.name | transloco }}
      </span>
    }
    <span class="app-title" [pTooltip]="'@HelloDATA' | transloco" tooltipPosition="bottom">
      {{ title() | transloco }}
    </span>
    @if ((currentUserContextRolesNotNone$ | async)?.length > 0) {
      @if ((selectedDataDomain$ | async); as selectedDataDomain) {
        <span class="data-domain-selector" [pTooltip]="'@Selected Data Domain' | transloco" tooltipPosition="bottom">
          <a (click)="selectedDataDomainMenu.toggle($event)"
             class="route-link p-button-link layout-topbar-button flex items-center" pRipple>
            <span class="pl-2 cursor-pointer truncate data-domain-name">
              {{ selectedDataDomain.name | transloco }}
            </span>
            <i class="fas fa-chevron-down p-1 cursor-pointer"></i>
          </a>
        </span>
      }
    }
  </div>

  <!--Right column -->
  <div class="flex items-center justify-end gap-4 shrink-0">
    @if ((userData$ | async); as userData) {
      @if ((languages$ | async); as languages) {
        <span class="top-menu-item flex items-center whitespace-nowrap">
          @for (item of supportedLanguages; track item.code; let last = $last) {
            <a class="cursor-pointer px-1"
               [ngClass]="{ 'selected-language': item.selected }"
               (click)="onLanguageChange(item.code)">
              {{ item.label }}
            </a>
            @if (!last) {
              <span class="mx-1">|</span>
            }
          }
        </span>
      }
      <span class="top-menu-item flex items-center">
        <a (click)="menu.toggle($event)"
           class="route-link p-button-link layout-topbar-button flex items-center"
           id="userMenu">
          <i class="fas fa-light fa-user cursor-pointer"></i>
          <span class="pl-2 hidden sm:inline cursor-pointer">
            {{ userData.email }}
          </span>
        </a>
      </span>
    }
  </div>
</div>


@if (isAuthenticated$ | async) {
  <app-published-announcements-wrapper class="published-announcements-container"
  />
}
<app-breadcrumb class="breadcrumb-container"/>
<!--use p-menu here with reference above due to firefox issues with z-index-->
<p-menu #menu [model]="userMenuItems" [popup]="true"/>
<p-menu #selectedDataDomainMenu [model]="dataDomainSelectionItems" [popup]="true"/>
